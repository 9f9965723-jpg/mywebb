const navLinks=document.querySelectorAll('.nav-link'),sections=document.querySelectorAll('section[id]');document.getElementById('hero').classList.add('active'),navLinks[0]?.classList.add('active'),navLinks.forEach(link=>{link.addEventListener('click',e=>{e.preventDefault();const targetId=link.getAttribute('href').substring(1);sections.forEach(section=>{section.classList.remove('active'),section.querySelectorAll('.reveal').forEach(el=>el.classList.remove('active'))}),navLinks.forEach(navLink=>navLink.classList.remove('active')),link.classList.add('active');const targetSection=document.getElementById(targetId);targetSection?.classList.add('active'),setTimeout(()=>{targetSection&&targetSection.querySelectorAll('.reveal').forEach(el=>el.classList.add('active'))},50),window.scrollTo({top:0,behavior:'smooth'})})});const navToggle=document.getElementById('nav-toggle'),navMenu=document.querySelector('.nav-menu');navToggle.addEventListener('click',()=>{navToggle.classList.toggle('active'),navMenu.classList.toggle('active')}),navLinks.forEach(link=>{link.addEventListener('click',()=>{navToggle.classList.remove('active'),navMenu.classList.remove('active')})});const navbar=document.getElementById('navbar');let scrollTicking=!1;window.addEventListener('scroll',()=>{scrollTicking||(window.requestAnimationFrame(()=>{window.scrollY>50?navbar.classList.add('scrolled'):navbar.classList.remove('scrolled'),scrollTicking=!1}),scrollTicking=!0)},{passive:!0});const cursor=document.querySelector('.cursor'),cursorDot=document.querySelector('.cursor-dot');let mouseX=0,mouseY=0,cursorX=0,cursorY=0,dotX=0,dotY=0;document.addEventListener('mousemove',e=>{mouseX=e.clientX,mouseY=e.clientY,dotX=mouseX,dotY=mouseY});function animateCursor(){cursorX+=(mouseX-cursorX)*.15,cursorY+=(mouseY-cursorY)*.15,cursor.style.left=cursorX+'px',cursor.style.top=cursorY+'px',cursorDot.style.left=dotX+'px',cursorDot.style.top=dotY+'px',requestAnimationFrame(animateCursor)}animateCursor(),document.querySelectorAll('a, button, [data-magnetic], input, textarea').forEach(el=>{el.addEventListener('mouseenter',()=>cursor.classList.add('hover')),el.addEventListener('mouseleave',()=>cursor.classList.remove('hover'))});const typingText=document.getElementById('typing-text'),texts=['مطور ويب محترف | Professional Web Developer','مصمم واجهات مستخدم | UI/UX Designer','مبرمج Full Stack | Full Stack Developer','مستشار تقني | Technical Consultant'];let textIndex=0,charIndex=0,isDeleting=!1,typingSpeed=100;function typeText(){const currentText=texts[textIndex];isDeleting?(typingText.textContent=currentText.substring(0,charIndex-1),charIndex--,typingSpeed=50):(typingText.textContent=currentText.substring(0,charIndex+1),charIndex++,typingSpeed=100),!isDeleting&&charIndex===currentText.length?(isDeleting=!0,typingSpeed=2e3):isDeleting&&0===charIndex&&(isDeleting=!1,textIndex=(textIndex+1)%texts.length,typingSpeed=500),setTimeout(typeText,typingSpeed)}setTimeout(typeText,1e3);let revealTicking=!1;function revealOnScroll(){const activeSection=document.querySelector('section.active');activeSection&&activeSection.querySelectorAll('.reveal').forEach(el=>el.classList.add('active'))}window.addEventListener('scroll',()=>{if(!revealTicking){window.requestAnimationFrame(()=>{const activeSection=document.querySelector('section.active');if(activeSection){const windowHeight=window.innerHeight;activeSection.querySelectorAll('.reveal').forEach(el=>{el.getBoundingClientRect().top<.85*windowHeight&&el.classList.add('active')})}revealTicking=!1}),revealTicking=!0}},{passive:!0}),revealOnScroll(),document.querySelectorAll('[data-magnetic]').forEach(el=>{el.addEventListener('mousemove',e=>{const rect=el.getBoundingClientRect(),x=e.clientX-rect.left-rect.width/2,y=e.clientY-rect.top-rect.height/2,moveX=.15*x,moveY=.15*y;el.style.transform=`translate(${moveX}px, ${moveY}px)`}),el.addEventListener('mouseleave',()=>el.style.transform='translate(0, 0)')}),document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener('click',function(e){const href=this.getAttribute('href');if('#'!==href&&!this.classList.contains('nav-link')){e.preventDefault();const targetId=href.substring(1);sections.forEach(section=>{section.classList.remove('active'),section.querySelectorAll('.reveal').forEach(el=>el.classList.remove('active'))}),navLinks.forEach(navLink=>navLink.classList.remove('active'));const targetSection=document.getElementById(targetId);targetSection?.classList.add('active'),document.querySelector(`.nav-link[href="${href}"]`)?.classList.add('active'),setTimeout(()=>{targetSection&&targetSection.querySelectorAll('.reveal').forEach(el=>el.classList.add('active'))},50),window.scrollTo({top:0,behavior:'smooth'})}})});const contactForm=document.getElementById('contact-form'),submitBtn=document.getElementById('submit-btn');contactForm.addEventListener('submit',async e=>{e.preventDefault();const originalBtnContent=submitBtn.innerHTML;submitBtn.innerHTML='<span>جاري الإرسال...</span> <i class="fas fa-spinner fa-spin"></i>',submitBtn.disabled=!0;try{const response=await fetch('https://api.web3forms.com/submit',{method:'POST',body:new FormData(contactForm)}),data=await response.json();data.success?(showMessage('✅ تم إرسال رسالتك بنجاح! سأتواصل معك قريباً.','success'),contactForm.reset()):showMessage('❌ حدث خطأ أثناء الإرسال. يرجى المحاولة مرة أخرى.','error')}catch(error){showMessage('❌ حدث خطأ في الاتصال. يرجى التحقق من الإنترنت والمحاولة مرة أخرى.','error')}finally{submitBtn.innerHTML=originalBtnContent,submitBtn.disabled=!1}});function showMessage(text,type){const message=document.createElement('div'),bgColor='success'===type?'rgba(0, 212, 255, 0.2)':'rgba(255, 50, 50, 0.2)',borderColor='success'===type?'var(--accent-neon)':'#ff3232';message.style.cssText=`position:fixed;top:100px;left:50%;transform:translateX(-50%);background:${bgColor};backdrop-filter:blur(10px);border:1px solid ${borderColor};padding:1.5rem 3rem;border-radius:16px;color:var(--text-primary);font-weight:600;z-index:10000;animation:slideDown 0.5s ease;max-width:90%;text-align:center;`,message.innerHTML=text,document.body.appendChild(message),setTimeout(()=>{message.style.animation='slideUp 0.5s ease',setTimeout(()=>message.remove(),500)},5e3)}const style=document.createElement('style');style.textContent='@keyframes slideDown{from{opacity:0;transform:translateX(-50%) translateY(-20px)}to{opacity:1;transform:translateX(-50%) translateY(0)}}@keyframes slideUp{from{opacity:1;transform:translateX(-50%) translateY(0)}to{opacity:0;transform:translateX(-50%) translateY(-20px)}}',document.head.appendChild(style),window.matchMedia('(prefers-reduced-motion: reduce)').matches&&document.querySelectorAll('*').forEach(el=>{el.style.animation='none',el.style.transition='none'});
